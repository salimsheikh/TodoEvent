<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Events List</title>

    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

</head>
<body>

<div class="container mt-5">
    <h3 class="mb-4">Events List</h3>

    <table class="table table-bordered table-striped">
        <thead class="table-dark">
            <tr>
                <th>ID</th>
                <th>Title</th>
                <th>Description</th>
                <th>Start</th>
                <th>End</th>
                <th>All Day</th>
            </tr>
        </thead>
        <tbody id="eventsTableBody">
            <tr>
                <td colspan="6" class="text-center">Loading...</td>
            </tr>
        </tbody>
    </table>
</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<script>
    const apiUrl = "https://localhost:7143/api/events/";

    async function loadEvents() {
        try {
            const response = await fetch(apiUrl);

            if (!response.ok) {
                throw new Error("Failed to fetch events");
            }

            const events = await response.json();

            const tbody = document.getElementById("eventsTableBody");
            tbody.innerHTML = "";

            if (events.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="6" class="text-center">No events found</td>
                    </tr>`;
                return;
            }

            events.forEach(event => {
                const row = `
                    <tr>
                        <td>${event.id}</td>
                        <td>${event.title}</td>
                        <td>${event.description}</td>
                        <td>${formatDate(event.start)}</td>
                        <td>${event.end ? formatDate(event.end) : '-'}</td>
                        <td>${event.allDay ? 'Yes' : 'No'}</td>
                    </tr>
                `;
                tbody.insertAdjacentHTML("beforeend", row);
            });

        } catch (error) {
            console.error(error);
            document.getElementById("eventsTableBody").innerHTML = `
                <tr>
                    <td colspan="6" class="text-danger text-center">
                        Error loading events
                    </td>
                </tr>`;
        }
    }

    function formatDate(dateString) {
        return new Date(dateString).toLocaleString();
    }

    // Load events on page load
    loadEvents();
</script>

</body>
</html>
